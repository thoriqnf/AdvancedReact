{
  "_args": [
    [
      {
        "raw": "graphql-deduplicator@^2.0.1",
        "scope": null,
        "escapedName": "graphql-deduplicator",
        "name": "graphql-deduplicator",
        "rawSpec": "^2.0.1",
        "spec": ">=2.0.1 <3.0.0",
        "type": "range"
      },
      "/Users/thoriqnurfaizal/Documents/GitHub/AdvancedReact/Backend/node_modules/graphql-yoga"
    ]
  ],
  "_from": "graphql-deduplicator@>=2.0.1 <3.0.0",
  "_id": "graphql-deduplicator@2.0.1",
  "_inCache": true,
  "_location": "/graphql-deduplicator",
  "_nodeVersion": "9.5.0",
  "_npmOperationalInternal": {
    "host": "s3://npm-registry-packages",
    "tmp": "tmp/graphql-deduplicator_2.0.1_1518606952367_0.9661714989915544"
  },
  "_npmUser": {
    "name": "gajus",
    "email": "gajus@gajus.com"
  },
  "_npmVersion": "5.6.0",
  "_phantomChildren": {},
  "_requested": {
    "raw": "graphql-deduplicator@^2.0.1",
    "scope": null,
    "escapedName": "graphql-deduplicator",
    "name": "graphql-deduplicator",
    "rawSpec": "^2.0.1",
    "spec": ">=2.0.1 <3.0.0",
    "type": "range"
  },
  "_requiredBy": [
    "/graphql-yoga"
  ],
  "_resolved": "https://registry.npmjs.org/graphql-deduplicator/-/graphql-deduplicator-2.0.1.tgz",
  "_shasum": "20c6b39e3a6f096b46dfc8491432818739c0ee37",
  "_shrinkwrap": null,
  "_spec": "graphql-deduplicator@^2.0.1",
  "_where": "/Users/thoriqnurfaizal/Documents/GitHub/AdvancedReact/Backend/node_modules/graphql-yoga",
  "author": {
    "name": "Gajus Kuizinas",
    "email": "gajus@gajus.com",
    "url": "http://gajus.com"
  },
  "ava": {
    "babel": {
      "babelrc": true
    },
    "require": "babel-register"
  },
  "bugs": {
    "url": "https://github.com/gajus/graphql-deduplicator/issues"
  },
  "dependencies": {},
  "description": "A GraphQL response deduplicator. Removes duplicate entities from the GraphQL response.",
  "devDependencies": {
    "ava": "^0.25.0",
    "babel-cli": "^6.26.0",
    "babel-plugin-istanbul": "^4.1.5",
    "babel-plugin-tailcall-optimization": "^1.0.12",
    "babel-plugin-transform-es2015-modules-commonjs": "^6.26.0",
    "babel-plugin-transform-flow-strip-types": "^6.22.0",
    "babel-preset-env": "^1.6.1",
    "babel-register": "^6.26.0",
    "coveralls": "^3.0.0",
    "eslint": "^4.17.0",
    "eslint-config-canonical": "^9.3.2",
    "flow-bin": "^0.65.0",
    "flow-copy-source": "^1.3.0",
    "husky": "^0.14.3",
    "nyc": "^11.4.1",
    "semantic-release": "^12.4.1"
  },
  "directories": {},
  "dist": {
    "integrity": "sha512-up9Bli3LEki/INLf+KyknHHf9mFKWjZBMIarfdI2YKvfWQPLsG4i2KwMCienzXoXmgbLx47aKVaUB5fswRNR2g==",
    "shasum": "20c6b39e3a6f096b46dfc8491432818739c0ee37",
    "tarball": "https://registry.npmjs.org/graphql-deduplicator/-/graphql-deduplicator-2.0.1.tgz",
    "fileCount": 15,
    "unpackedSize": 25691
  },
  "engines": {
    "node": ">6.0.0"
  },
  "gitHead": "48080d0fef3b6b78b57303723c40643155be0db8",
  "homepage": "https://github.com/gajus/graphql-deduplicator#readme",
  "keywords": [
    "graphql",
    "apollo",
    "deduplicator",
    "normalizer"
  ],
  "license": "BSD-3-Clause",
  "main": "./dist/index.js",
  "maintainers": [
    {
      "name": "gajus",
      "email": "gajus@gajus.com"
    }
  ],
  "name": "graphql-deduplicator",
  "nyc": {
    "include": [
      "src/**/*.js"
    ],
    "instrument": false,
    "reporter": [
      "text-lcov"
    ],
    "require": [
      "babel-register"
    ],
    "sourceMap": false
  },
  "optionalDependencies": {},
  "readme": "# graphql-deduplicator\n\n[![Travis build status](http://img.shields.io/travis/gajus/graphql-deduplicator/master.svg?style=flat-square)](https://travis-ci.org/gajus/graphql-deduplicator)\n[![Coveralls](https://img.shields.io/coveralls/gajus/graphql-deduplicator.svg?style=flat-square)](https://github.com/gajus/graphql-deduplicator)\n[![NPM version](http://img.shields.io/npm/v/graphql-deduplicator.svg?style=flat-square)](https://www.npmjs.org/package/graphql-deduplicator)\n[![Canonical Code Style](https://img.shields.io/badge/code%20style-canonical-blue.svg?style=flat-square)](https://github.com/gajus/canonical)\n\nA GraphQL response deduplicator.\n\nRemoves duplicate entities from the GraphQL response.\n\n* [Client support](#client-support)\n* [How does it work?](#how-does-it-work)\n* [Motivation](#motivation)\n* [Real-life example](#real-life-example)\n* [Usage](#usage)\n  * [Server-side](#server-side)\n  * [Client-side](#client-side)\n\n## Client support\n\n`graphql-deduplicator` has been tested with [`apollo-client`](https://github.com/apollographql/apollo-client).\n\nHowever, it should work with any GraphQL client that automatically appends `__typename` and `id` fields for every resource. If your client automatically does not request `__typename` and `id` fields, these fields can be specified in your GraphQL query.\n\n## How does it work?\n\n`apollo-client` uses `__typename` and an `id` values to construct a resource identifier. The resource identifier is used to [normalize data](http://dev.apollodata.com/core/how-it-works.html#normalize). As a result, when GraphQL API response contains a resource with a repeating identifier, the `apollo-client` is going to read only the first instance of the resource and ignore duplicate entities. `graphql-deduplicator` strips body (fields other than `__datatype` and `id`) from all the duplicate entities.\n\n## Motivation\n\n`graphql-deduplicator` is designed to reduce the GraphQL response size by removing body of duplicate entities. This allows to make queries that return large result sets of repeated data without worrying about the cost of the response body size, time it takes to parse the response or the memory the reconstructed object will consume.\n\n## Real-life example\n\nConsider the following schema:\n\n```graphql\ninterface Node {\n  id: ID!\n}\n\ntype Movie implements Node {\n  id: ID!\n  name: String!\n  synopsis: String!\n}\n\ntype Event implements Node {\n  id: ID!\n  movie: Movie!\n  # YYYY-MM-DD\n  date: String!\n  # HH:mm\n  time: String!\n}\n\ntype Query {\n  events (\n    date: String\n  ): [Event!]!\n}\n\n```\n\nUsing this schema, you can query events for a particular date, e.g.\n\n```graphql\n{\n  events (date: \"2017-05-19\") {\n    __typename\n    id\n    date\n    time\n    movie {\n      __typename\n      id\n      name\n      synopsis\n    }\n  }\n}\n\n```\n\n> Note: If you are using `apollo-client`, then you do not need to include `__typename` when constructing the query. `apollo-client` will do this for you.\n\nThe result of the above query will contain a lot of duplicate information.\n\n```json\n{\n  \"data\": {\n    \"events\": [\n      {\n        \"__typename\": \"Event\",\n        \"id\": \"1669971\",\n        \"date\": \"2017-05-19\",\n        \"time\": \"17:25\",\n        \"movie\": {\n          \"__typename\": \"Movie\",\n          \"id\": \"1198359\",\n          \"name\": \"King Arthur: Legend of the Sword\",\n          \"synopsis\": \"When the child Arthur’s father is murdered, Vortigern, Arthur’s uncle, seizes the crown. Robbed of his birthright and with no idea who he truly is, Arthur comes up the hard way in the back alleys of the city. But once he pulls the sword Excalibur from the stone, his life is turned upside down and he is forced to acknowledge his true legacy... whether he likes it or not.\"\n        }\n      },\n      {\n        \"__typename\": \"Event\",\n        \"id\": \"1669972\",\n        \"date\": \"2017-05-19\",\n        \"time\": \"20:30\",\n        \"movie\": {\n          \"__typename\": \"Movie\",\n          \"id\": \"1198359\",\n          \"name\": \"King Arthur: Legend of the Sword\",\n          \"synopsis\": \"When the child Arthur’s father is murdered, Vortigern, Arthur’s uncle, seizes the crown. Robbed of his birthright and with no idea who he truly is, Arthur comes up the hard way in the back alleys of the city. But once he pulls the sword Excalibur from the stone, his life is turned upside down and he is forced to acknowledge his true legacy... whether he likes it or not.\"\n        }\n      },\n      // ...\n    ]\n  }\n}\n\n```\n\nI've run into this situation when building https://gotocinema.com. A query retrieving 300 events (movie screening event) produced a response of 1.5MB. When gziped, that number dropped to 100KB. However, the problem is that upon receiving the response, the browser needs to parse the entire JSON document. Parsing 1.5MB JSON string is (a) time consuming and (b) memory expensive.\n\nThe good news is that we do not need to return body of duplicate records (see [How does it work?](#how-does-it-work)). For all duplicate records we only need to return `__typename` and `id`. This information is enough for `apollo-client` to identify the resource as duplicate and skip it. In case when a response includes large and often repeated fragments, this will reduce the response size 10x, 100x or more times.\n\nIn case of the earlier example, the response becomes:\n\n```json\n{\n  \"data\": {\n    \"events\": [\n      {\n        \"__typename\": \"Event\",\n        \"id\": \"1669971\",\n        \"date\": \"2017-05-19\",\n        \"time\": \"17:25\",\n        \"movie\": {\n          \"__typename\": \"Movie\",\n          \"id\": \"1198359\",\n          \"name\": \"King Arthur: Legend of the Sword\",\n          \"synopsis\": \"When the child Arthur’s father is murdered, Vortigern, Arthur’s uncle, seizes the crown. Robbed of his birthright and with no idea who he truly is, Arthur comes up the hard way in the back alleys of the city. But once he pulls the sword Excalibur from the stone, his life is turned upside down and he is forced to acknowledge his true legacy... whether he likes it or not.\"\n        }\n      },\n      {\n        \"__typename\": \"Event\",\n        \"id\": \"1669972\",\n        \"date\": \"2017-05-19\",\n        \"time\": \"20:30\",\n        \"movie\": {\n          \"__typename\": \"Movie\",\n          \"id\": \"1198359\"\n        }\n      },\n      // ...\n    ]\n  }\n}\n\n```\n\nThe `synopsis` and `name` fields have been removed from the duplicate `Movie` entity.\n\n## Usage\n\n### Server-side\n\nYou need to format the final result of the query. If you are using [`graphql-server`](https://github.com/apollographql/graphql-server), configure `formatResponse`, e.g.\n\n```js\nimport express from 'express';\nimport {\n  graphqlExpress\n} from 'graphql-server-express';\nimport {\n  deflate\n} from 'graphql-deduplicator';\n\nconst SERVICE_PORT = 3000;\n\nconst app = express();\n\napp.use('/graphql', graphqlExpress(() => {\n  return {\n    formatResponse: (response) => {\n      if (response.data && !response.data.__schema) {\n        return deflate(response.data);\n      }\n\n      return response;\n    }\n  };\n}));\n\napp.listen(SERVICE_PORT);\n\n```\n\n### Client-side\n\nYou need to modify the server response before it is processed by the GraphQL client. If you are using [`apollo-client`](https://github.com/apollographql/apollo-client), use [`link`](https://www.apollographql.com/docs/react/reference/index.html#types) configuration to setup an [afterware](https://www.apollographql.com/docs/react/basics/network-layer.html#linkAfterware), e.g.\n\n```js\n// @flow\n\nimport {\n  ApolloClient\n} from 'apollo-client';\nimport {\n  ApolloLink,\n  concat\n} from 'apollo-link';\nimport {\n  HttpLink\n} from 'apollo-link-http';\nimport {\n  inflate\n} from 'graphql-deduplicator';\n\nconst httpLink = new HttpLink({\n  credentials: 'include',\n  uri: '/api'\n});\n\nconst inflateLink = new ApolloLink((operation, forward) => {\n  return forward(operation)\n    .map((response) => {\n      return inflate(response);\n    });\n});\n\nconst apolloClient = new ApolloClient({\n  link: concat(inflateLink, httpLink)\n});\n\nexport default apolloClient;\n\n```\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/gajus/graphql-deduplicator.git"
  },
  "scripts": {
    "build": "rm -fr ./dist && NODE_ENV=production babel ./src --out-dir ./dist --copy-files --source-maps && flow-copy-source src dist",
    "lint": "eslint ./src ./test && flow",
    "precommit": "npm run lint && npm run test && npm run build",
    "test": "NODE_ENV=test nyc --reporter=text ava --verbose --serial"
  },
  "version": "2.0.1"
}
